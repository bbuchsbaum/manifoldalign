% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kema.R
\name{kema.multidesign}
\alias{kema.multidesign}
\title{Kernel Manifold Alignment for Multidesign Data}
\usage{
\method{kema}{multidesign}(
  data,
  y,
  subject,
  preproc = center(),
  ncomp = 2,
  knn = 5,
  sigma = 0.73,
  u = 0.5,
  kernel = coskern(),
  sample_frac = 1,
  use_laplacian = TRUE,
  solver = "regression",
  dweight = 0.1,
  rweight = 0,
  simfun = neighborweights::binary_label_matrix,
  disfun = NULL,
  lambda = 1e-04,
  centre_kernel = FALSE,
  ...
)
}
\arguments{
\item{data}{A multidesign object containing data with subject groupings}

\item{y}{Name of the label variable to use for alignment (can contain NA 
for unlabeled samples)}

\item{subject}{Name of the subject variable that defines the domains/strata}

\item{preproc}{Preprocessing function to apply to the data (default: 
center())}

\item{ncomp}{Number of components to extract (default: 2)}

\item{knn}{Number of nearest neighbors for graph construction (default: 5)}

\item{sigma}{Kernel bandwidth parameter (default: 0.73)}

\item{u}{Trade-off parameter between data geometry and class alignment 
(0-1, default: 0.5)}

\item{kernel}{Kernel function to use (default: coskern())}

\item{sample_frac}{Fraction of samples to use for kernel approximation 
(default: 1)}

\item{use_laplacian}{Whether to use Laplacian normalization (default: TRUE)}

\item{solver}{Solver method: "regression" for fast approximation (default) 
or "exact" for precise solution}

\item{dweight}{Weight for dissimilarity/repulsion terms (default: 0.1)}

\item{rweight}{Weight for repulsion graph (default: 0)}

\item{simfun}{Function to compute similarity between labels}

\item{disfun}{Function to compute dissimilarity between labels (optional)}

\item{lambda}{Regularization parameter for matrix conditioning 
(default: 0.0001)}

\item{centre_kernel}{Whether to center kernel matrices (default: FALSE). 
**[EXTENSION]** The original paper uses uncentered kernels. Set TRUE for 
centered variant.}

\item{...}{Additional arguments (currently unused)}
}
\value{
A multiblock_biprojector object containing the KEMA alignment
}
\description{
Performs Kernel Manifold Alignment on multidesign data structures. 
Automatically splits data by subject variable and aligns domains.
}
\examples{
\donttest{
# Example with multidesign data
library(multidesign)

# Create synthetic multi-subject data
set.seed(123)
data_design <- expand.grid(
  subject = factor(1:4),
  condition = factor(c("A", "B")),
  trial = 1:10
)

# Generate synthetic data matrix
n_obs <- nrow(data_design)
n_features <- 20
X <- matrix(rnorm(n_obs * n_features), n_obs, n_features)

# Create multidesign object
md <- multidesign(X, data_design)

# Run KEMA alignment across subjects
result <- kema(md, y = condition, subject = subject, ncomp = 2)

# Semi-supervised learning with missing labels
data_design$condition[sample(nrow(data_design), 20)] <- NA
md_semi <- multidesign(X, data_design)
result_semi <- kema(md_semi, y = condition, subject = subject, ncomp = 2)
}

}
