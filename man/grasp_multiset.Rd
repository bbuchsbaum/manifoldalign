% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_generic.R, R/grasp_multiset.R
\name{grasp_multiset}
\alias{grasp_multiset}
\title{Multi-Graph GRASP: Graph Alignment by Spectral Corresponding Functions}
\usage{
grasp_multiset(data, ...)

grasp_multiset(data, ...)
}
\arguments{
\item{data}{Input data containing three or more graph domains. Can be:
\itemize{
  \item A \code{hyperdesign} object with 3+ domains
  \item A list of 3+ matrices (nodes x features)
}}

\item{...}{Additional arguments (currently unused)}

\item{ncomp}{Number of spectral components to extract (default: 30)}

\item{q_descriptors}{Number of diffusion-time descriptors (default: 100)}

\item{sigma}{Diffusion parameter for descriptor computation (default: 0.73)}

\item{lambda}{Regularization parameter for base alignment (default: 0.1)}

\item{use_laplacian}{Whether to use Laplacian normalization (default: TRUE)}

\item{anchor}{Index of reference graph or "mean" for barycenter (default: 1)}

\item{solver}{Assignment method: "auction" (default) or "linear"}

\item{max_iter}{Maximum iterations for joint alignment (default: 100)}

\item{tol}{Convergence tolerance (default: 1e-6)}
}
\value{
A \code{grasp_multiset} object containing alignment results
  for all graphs

A \code{grasp_multiset} object containing:
\itemize{
  \item \code{embeddings}: List of aligned embeddings for each graph
  \item \code{permutations}: List of permutation matrices to reference
  \item \code{rotations}: List of orthogonal rotation matrices
  \item \code{mapping_diag}: List of diagonal mapping matrices
  \item \code{anchor}: The anchor index or "mean"
  \item \code{iterations}: Number of iterations until convergence
}
}
\description{
Performs GRASP alignment on three or more graph domains simultaneously. Extends
the pairwise GRASP algorithm to handle multiple graphs through joint diagonalization
and shared latent basis alignment.

The multi-graph GRASP algorithm works by:
\enumerate{
  \item Computing spectral bases and descriptors for each graph
  \item Joint diagonalization: Finding rotations that simultaneously align all graphs
  \item Shared latent basis: Projecting all graphs to a common anchor space
  \item Computing assignments between graphs (typically to a reference)
}

The method minimizes:
\deqn{\sum_{s=1}^{m} \mathrm{off}((M^{(s)})^T \Lambda^{(s)} M^{(s)}) + 
      \lambda \sum_{s<t} ||F^{(s)T} \Phi^{(s)} - F^{(t)T} \Phi^{(t)} M^{(t)} (M^{(s)})^T||_F^2}
}
\details{
Performs GRASP alignment on three or more graph domains simultaneously. Extends
the pairwise GRASP algorithm to handle multiple graphs through joint diagonalization
and shared latent basis alignment.
}
\examples{
\donttest{
# Example with multiple synthetic graphs
set.seed(123)
graphs <- lapply(1:4, function(i) matrix(rnorm(50*3), 50, 3))
result <- grasp_multiset(graphs, ncomp = 20, q_descriptors = 50)

# Access results
length(result$embeddings)  # 4 aligned embeddings
dim(result$embeddings[[1]])  # 50 x 20

# Use mean as anchor instead of first graph
result_mean <- grasp_multiset(graphs, anchor = "mean")
}

}
\references{
Ovsjanikov, M., Ben-Chen, M., Solomon, J., Butscher, A., & Guibas, L. (2012). 
Functional maps: a flexible representation of maps between shapes. ACM 
Transactions on Graphics, 31(4), 1-11.
}
\seealso{
\code{\link{grasp}} for pairwise alignment, 
  \code{\link{grasp_multiset.hyperdesign}} for detailed documentation

\code{\link{grasp}} for pairwise alignment
}
